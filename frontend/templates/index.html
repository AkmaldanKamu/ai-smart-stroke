<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>AI-SMART - Deteksi Stroke</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>ğŸ§  AI-SMART: Sistem Deteksi Stroke</h1>

  <!-- Webcam Video Preview -->
  <video id="video" width="400" height="300" autoplay muted></video>

  <br><br>

  <!-- Tombol Tes Deteksi -->
  <button onclick="deteksiWajah()">ğŸ˜Š Tes Ekspresi Wajah</button>
  <button onclick="deteksiTangan()">ğŸ–ï¸ Tes Gerakan Tangan</button>
  <button id="btn-voice" onclick="mulaiTesSuara()">ğŸ¤ Tes Ucapan</button>

  <br><br>

  <!-- Status dan Hasil -->
  <p id="hasil-wajah"></p>
  <p id="hasil-tangan"></p>
  <p id="status-audio"></p>

  <script>
    // Aktifkan Webcam
    const video = document.getElementById("video");
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
      })
      .catch(error => {
        alert("Webcam tidak tersedia: " + error);
      });

    // Dummy Function: Deteksi Wajah (Nanti kita konek ke backend OpenCV)
    function deteksiWajah() {
      document.getElementById("hasil-wajah").innerText = "ğŸ‘ï¸ Mendeteksi ekspresi wajah...";
      setTimeout(() => {
        document.getElementById("hasil-wajah").innerText = "âœ… Wajah: Normal (tidak miring)";
        // nanti bisa ambil dari backend, misalnya fetch('/detect-face')
      }, 1500);
    }

    // Dummy Function: Deteksi Gerakan Tangan
    function deteksiTangan() {
      document.getElementById("hasil-tangan").innerText = "ğŸ–ï¸ Mendeteksi posisi tangan...";
      setTimeout(() => {
        document.getElementById("hasil-tangan").innerText = "âœ… Tangan: Kedua tangan naik";
      }, 1500);
    }

    // Tes Ucapan dengan Batas Waktu 5 detik
    function mulaiTesSuara() {
      const status = document.getElementById("status-audio");
      const btn = document.getElementById("btn-voice");

      btn.disabled = true;
      status.innerText = "â±ï¸ Merekam suara selama 5 detik...";

      setTimeout(() => {
        status.innerText = "ğŸ§  Menganalisis suara...";
      }, 5000);

      fetch('/analyze-audio', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
          status.innerText = "âœ… Hasil Suara: " + data.hasil;
          btn.disabled = false;
        })
        .catch(error => {
          status.innerText = "âŒ Gagal menganalisis suara.";
          console.error(error);
          btn.disabled = false;
        });
    }
  </script>
</body>
</html>
